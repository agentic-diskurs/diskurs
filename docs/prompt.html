<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-prompt" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.1">
<title data-rh="true">Module: Prompt | Diskurs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://agentic-diskurs.github.io/diskurs/img/diskurs-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://agentic-diskurs.github.io/diskurs/img/diskurs-social-card.jpg"><meta data-rh="true" property="og:url" content="https://agentic-diskurs.github.io/diskurs/docs/prompt"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Module: Prompt | Diskurs"><meta data-rh="true" name="description" content="exception diskurs.prompt.PromptValidationError(message)"><meta data-rh="true" property="og:description" content="exception diskurs.prompt.PromptValidationError(message)"><link data-rh="true" rel="icon" href="/diskurs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://agentic-diskurs.github.io/diskurs/docs/prompt"><link data-rh="true" rel="alternate" href="https://agentic-diskurs.github.io/diskurs/docs/prompt" hreflang="en"><link data-rh="true" rel="alternate" href="https://agentic-diskurs.github.io/diskurs/docs/prompt" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/diskurs/blog/rss.xml" title="Diskurs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/diskurs/blog/atom.xml" title="Diskurs Atom Feed"><link rel="stylesheet" href="/diskurs/assets/css/styles.7a6aa77d.css">
<script src="/diskurs/assets/js/runtime~main.d886a170.js" defer="defer"></script>
<script src="/diskurs/assets/js/main.edf29e07.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/diskurs/"><div class="navbar__logo"><img src="/diskurs/img/logo.svg" alt="Diskurs Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/diskurs/img/logo.svg" alt="Diskurs Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Diskurs</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/diskurs/docs/intro">Documentation</a><a class="navbar__item navbar__link" href="/diskurs/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/agentic-diskurs/diskurs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/diskurs/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/diskurs/docs/category/tutorial---basics">Tutorial - Basics</a><button aria-label="Expand sidebar category &#x27;Tutorial - Basics&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/diskurs/docs/category/tutorial---extras">Tutorial - Extras</a><button aria-label="Expand sidebar category &#x27;Tutorial - Extras&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/diskurs/docs/conductor_agent">Module: Conductor Agent</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/diskurs/docs/dispatcher">Module: Dispatcher</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/diskurs/docs/filesystem_conversation_store">Module: Filesystem Conversation Store</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/diskurs/docs/heuristic_agent">Module: Heuristic Agent</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/diskurs/docs/immutable_conversation">Module: Immutable Conversation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/diskurs/docs">Welcome to Diskurs’s documentation!</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/diskurs/docs/llm_client">Module: LLM Client</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/diskurs/docs/multistep_agent">Module: Multistep Agent</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/diskurs/docs/prompt">Module: Prompt</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/diskurs/docs/protocols">Protocols</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/diskurs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Module: Prompt</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Module: Prompt</h1></header>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exception-diskurspromptpromptvalidationerrormessage"><em>exception</em> diskurs.prompt.PromptValidationError(message)<a href="#exception-diskurspromptpromptvalidationerrormessage" class="hash-link" aria-label="Direct link to exception-diskurspromptpromptvalidationerrormessage" title="Direct link to exception-diskurspromptpromptvalidationerrormessage">​</a></h3>
<p>Bases: <code>Exception</code></p>
<ul>
<li><strong>Parameters:</strong>
<strong>message</strong> (<em>str</em>)</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="add_note">add_note()<a href="#add_note" class="hash-link" aria-label="Direct link to add_note()" title="Direct link to add_note()">​</a></h4>
<p>Exception.add_note(note) –
add a note to the exception</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="args">args<a href="#args" class="hash-link" aria-label="Direct link to args" title="Direct link to args">​</a></h4>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="with_traceback">with_traceback()<a href="#with_traceback" class="hash-link" aria-label="Direct link to with_traceback()" title="Direct link to with_traceback()">​</a></h4>
<p>Exception.with_traceback(tb) –
set self.<em>_traceback</em>_ to tb and return self.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="class-diskurspromptdefaultconductorsystempromptargumentagent_descriptions"><em>class</em> diskurs.prompt.DefaultConductorSystemPromptArgument(agent_descriptions)<a href="#class-diskurspromptdefaultconductorsystempromptargumentagent_descriptions" class="hash-link" aria-label="Direct link to class-diskurspromptdefaultconductorsystempromptargumentagent_descriptions" title="Direct link to class-diskurspromptdefaultconductorsystempromptargumentagent_descriptions">​</a></h3>
<p>Bases: <code>PromptArgument</code></p>
<ul>
<li><strong>Parameters:</strong>
<strong>agent_descriptions</strong> (<em>dict</em> *[*<em>str</em> <em>,</em> <em>str</em> <em>]</em>)</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="agent_descriptions--dictstr-str">agent_descriptions <em>: <code>dict</code>[<code>str</code>, <code>str</code>]</em><a href="#agent_descriptions--dictstr-str" class="hash-link" aria-label="Direct link to agent_descriptions--dictstr-str" title="Direct link to agent_descriptions--dictstr-str">​</a></h4>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="classmethod-from_dictdata"><em>classmethod</em> from_dict(data)<a href="#classmethod-from_dictdata" class="hash-link" aria-label="Direct link to classmethod-from_dictdata" title="Direct link to classmethod-from_dictdata">​</a></h4>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="to_dict">to_dict()<a href="#to_dict" class="hash-link" aria-label="Direct link to to_dict()" title="Direct link to to_dict()">​</a></h4>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="class-diskurspromptdefaultconductoruserpromptargumentnext_agentnone"><em>class</em> diskurs.prompt.DefaultConductorUserPromptArgument(next_agent=None)<a href="#class-diskurspromptdefaultconductoruserpromptargumentnext_agentnone" class="hash-link" aria-label="Direct link to class-diskurspromptdefaultconductoruserpromptargumentnext_agentnone" title="Direct link to class-diskurspromptdefaultconductoruserpromptargumentnext_agentnone">​</a></h3>
<p>Bases: <code>PromptArgument</code></p>
<ul>
<li><strong>Parameters:</strong>
<strong>next_agent</strong> (<em>str</em> <em>|</em> <em>None</em>)</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="next_agent--optionalstr--none">next_agent <em>: <code>Optional</code>[<code>str</code>]</em> <em>= None</em><a href="#next_agent--optionalstr--none" class="hash-link" aria-label="Direct link to next_agent--optionalstr--none" title="Direct link to next_agent--optionalstr--none">​</a></h4>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="classmethod-from_dictdata-1"><em>classmethod</em> from_dict(data)<a href="#classmethod-from_dictdata-1" class="hash-link" aria-label="Direct link to classmethod-from_dictdata-1" title="Direct link to classmethod-from_dictdata-1">​</a></h4>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="to_dict-1">to_dict()<a href="#to_dict-1" class="hash-link" aria-label="Direct link to to_dict()" title="Direct link to to_dict()">​</a></h4>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="diskurspromptload_symbolsymbol_name-loaded_module">diskurs.prompt.load_symbol(symbol_name, loaded_module)<a href="#diskurspromptload_symbolsymbol_name-loaded_module" class="hash-link" aria-label="Direct link to diskurs.prompt.load_symbol(symbol_name, loaded_module)" title="Direct link to diskurs.prompt.load_symbol(symbol_name, loaded_module)">​</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="diskurspromptload_templatelocation">diskurs.prompt.load_template(location)<a href="#diskurspromptload_templatelocation" class="hash-link" aria-label="Direct link to diskurs.prompt.load_template(location)" title="Direct link to diskurs.prompt.load_template(location)">​</a></h3>
<p>Loads a Jinja2 template from the provided file path.</p>
<ul>
<li><strong>Parameters:</strong>
<strong>location</strong> (<code>Path</code>) – Path to the template file.</li>
<li><strong>Return type:</strong>
<code>Template</code></li>
<li><strong>Returns:</strong>
Jinja2 Template object.</li>
<li><strong>Raises:</strong>
<strong>FileNotFoundError</strong> – If the template file does not exist.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="class-diskurspromptpromptparsermixin"><em>class</em> diskurs.prompt.PromptParserMixin<a href="#class-diskurspromptpromptparsermixin" class="hash-link" aria-label="Direct link to class-diskurspromptpromptparsermixin" title="Direct link to class-diskurspromptpromptparsermixin">​</a></h3>
<p>Bases: <code>object</code></p>
<p>Mixin to handle parsing and validation of LLM responses into dataclasses.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="classmethod-validate_dataclassparsed_response-user_prompt_argument-strictfalse"><em>classmethod</em> validate_dataclass(parsed_response, user_prompt_argument, strict=False)<a href="#classmethod-validate_dataclassparsed_response-user_prompt_argument-strictfalse" class="hash-link" aria-label="Direct link to classmethod-validate_dataclassparsed_response-user_prompt_argument-strictfalse" title="Direct link to classmethod-validate_dataclassparsed_response-user_prompt_argument-strictfalse">​</a></h4>
<p>Validate that the JSON fields match the target dataclass.
In strict mode, all fields must be present. If not strict, all required fields (without default values)
must be present at minimum.</p>
<ul>
<li><strong>Parameters:</strong>
<ul>
<li><strong>parsed_response</strong> (<code>dict</code>[<code>str</code>, <code>Any</code>]) – Dictionary representing the LLM’s response.</li>
<li><strong>user_prompt_argument</strong> (<code>Type</code>[<code>dataclass</code>]) – The dataclass type to validate against.</li>
<li><strong>strict</strong> (<code>bool</code>) – If True, all fields must be present. If False, required fields must be present.</li>
</ul>
</li>
<li><strong>Return type:</strong>
<code>dataclass</code></li>
<li><strong>Returns:</strong>
An instance of the dataclass if validation succeeds.</li>
<li><strong>Raises:</strong>
LLMResponseParseError if validation fails.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="classmethod-validate_jsonllm_response"><em>classmethod</em> validate_json(llm_response)<a href="#classmethod-validate_jsonllm_response" class="hash-link" aria-label="Direct link to classmethod-validate_jsonllm_response" title="Direct link to classmethod-validate_jsonllm_response">​</a></h4>
<p>Parse and validate the LLM response as JSON, handling nested JSON strings.</p>
<ul>
<li><strong>Parameters:</strong>
<strong>llm_response</strong> (<code>str</code>) – The raw text response from the LLM.</li>
<li><strong>Return type:</strong>
<code>dict</code></li>
<li><strong>Returns:</strong>
Parsed dictionary if valid JSON.</li>
<li><strong>Raises:</strong>
<a href="#diskurs.prompt.PromptValidationError"><strong>PromptValidationError</strong></a> – If the response is not valid JSON.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="parse_user_promptllm_response-old_user_prompt_argument-message_typemessagetyperouting">parse_user_prompt(llm_response, old_user_prompt_argument, message_type=MessageType.ROUTING)<a href="#parse_user_promptllm_response-old_user_prompt_argument-message_typemessagetyperouting" class="hash-link" aria-label="Direct link to parse_user_prompt(llm_response, old_user_prompt_argument, message_type=MessageType.ROUTING)" title="Direct link to parse_user_prompt(llm_response, old_user_prompt_argument, message_type=MessageType.ROUTING)">​</a></h4>
<p>Parse the text returned from the LLM into a structured prompt argument.
First validate the text, then parse it into the prompt argument.
If the text is not valid, raise a PromptValidationError, and generate a user prompt with the error message,
for the LLM to correct its output.</p>
<ul>
<li><strong>Parameters:</strong>
<ul>
<li><strong>llm_response</strong> (<code>str</code>) – Response from the LLM.</li>
<li><strong>old_user_prompt_argument</strong> (<em>PromptArgument</em>)</li>
<li><strong>message_type</strong> (<em>MessageType</em>)</li>
</ul>
</li>
<li><strong>Return type:</strong>
<em>PromptArgument</em> | <em>ChatMessage</em></li>
</ul>
<p>:param<!-- --> old_user_prompt_argument
<!-- -->:type<!-- --> message_type: <code>MessageType</code>
<!-- -->:param<!-- --> message_type: Type of message to be created.
:rtype: <code>PromptArgument</code> | <code>ChatMessage</code>
:return: Validated prompt argument or a ChatMessage with an error message.
<!-- -->:raises<!-- --> PromptValidationError: If the text is not valid.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="class-diskurspromptpromptrenderermixinsystem_prompt_argument_class-user_prompt_argument_class-system_template-user_template-json_formatting_templatenone-is_validnone-is_finalnone"><em>class</em> diskurs.prompt.PromptRendererMixin(system_prompt_argument_class, user_prompt_argument_class, system_template, user_template, json_formatting_template=None, is_valid=None, is_final=None)<a href="#class-diskurspromptpromptrenderermixinsystem_prompt_argument_class-user_prompt_argument_class-system_template-user_template-json_formatting_templatenone-is_validnone-is_finalnone" class="hash-link" aria-label="Direct link to class-diskurspromptpromptrenderermixinsystem_prompt_argument_class-user_prompt_argument_class-system_template-user_template-json_formatting_templatenone-is_validnone-is_finalnone" title="Direct link to class-diskurspromptpromptrenderermixinsystem_prompt_argument_class-user_prompt_argument_class-system_template-user_template-json_formatting_templatenone-is_validnone-is_finalnone">​</a></h3>
<p>Bases: <code>object</code></p>
<p>Mixin to handle the rendering of system and user templates, as well as validation
This class can be reused across prompts.</p>
<ul>
<li><strong>Parameters:</strong>
<ul>
<li><strong>system_prompt_argument_class</strong> (<em>Type</em> *[*<em>SystemPromptArg</em> <em>]</em>)</li>
<li><strong>user_prompt_argument_class</strong> (<em>Type</em> *[*<em>UserPromptArg</em> <em>]</em>)</li>
<li><strong>system_template</strong> (<em>Template</em>)</li>
<li><strong>user_template</strong> (<em>Template</em>)</li>
<li><strong>json_formatting_template</strong> (<em>Template</em> <em>|</em> <em>None</em>)</li>
<li><strong>is_valid</strong> (<em>Callable</em> <em>[</em> *[*<em>UserPromptArg</em> <em>]</em> <em>,</em> <em>bool</em> <em>]</em>  <em>|</em> <em>None</em>)</li>
<li><strong>is_final</strong> (<em>Callable</em> <em>[</em> *[*<em>UserPromptArg</em> <em>]</em> <em>,</em> <em>bool</em> <em>]</em>  <em>|</em> <em>None</em>)</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="is_finaluser_prompt_argument">is_final(user_prompt_argument)<a href="#is_finaluser_prompt_argument" class="hash-link" aria-label="Direct link to is_final(user_prompt_argument)" title="Direct link to is_final(user_prompt_argument)">​</a></h4>
<ul>
<li><strong>Return type:</strong>
<code>bool</code></li>
<li><strong>Parameters:</strong>
<strong>user_prompt_argument</strong> (<em>PromptArgument</em>)</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="is_validuser_prompt_argument">is_valid(user_prompt_argument)<a href="#is_validuser_prompt_argument" class="hash-link" aria-label="Direct link to is_valid(user_prompt_argument)" title="Direct link to is_valid(user_prompt_argument)">​</a></h4>
<ul>
<li><strong>Return type:</strong>
<code>bool</code></li>
<li><strong>Parameters:</strong>
<strong>user_prompt_argument</strong> (<em>PromptArgument</em>)</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create_system_prompt_argumentprompt_args">create_system_prompt_argument(**prompt_args)<a href="#create_system_prompt_argumentprompt_args" class="hash-link" aria-label="Direct link to create_system_prompt_argument(**prompt_args)" title="Direct link to create_system_prompt_argument(**prompt_args)">​</a></h4>
<ul>
<li><strong>Return type:</strong>
<code>TypeVar</code>(<code>SystemPromptArg</code>)</li>
<li><strong>Parameters:</strong>
<strong>prompt_args</strong> (<em>dict</em>)</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create_user_prompt_argumentprompt_args">create_user_prompt_argument(**prompt_args)<a href="#create_user_prompt_argumentprompt_args" class="hash-link" aria-label="Direct link to create_user_prompt_argument(**prompt_args)" title="Direct link to create_user_prompt_argument(**prompt_args)">​</a></h4>
<ul>
<li><strong>Return type:</strong>
<code>TypeVar</code>(<code>UserPromptArg</code>)</li>
<li><strong>Parameters:</strong>
<strong>prompt_args</strong> (<em>dict</em>)</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="render_json_formatting_promptprompt_args">render_json_formatting_prompt(prompt_args)<a href="#render_json_formatting_promptprompt_args" class="hash-link" aria-label="Direct link to render_json_formatting_prompt(prompt_args)" title="Direct link to render_json_formatting_prompt(prompt_args)">​</a></h4>
<ul>
<li><strong>Return type:</strong>
<code>str</code></li>
<li><strong>Parameters:</strong>
<strong>prompt_args</strong> (<em>dict</em>)</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="render_system_templatename-prompt_args-return_jsontrue">render_system_template(name, prompt_args, return_json=True)<a href="#render_system_templatename-prompt_args-return_jsontrue" class="hash-link" aria-label="Direct link to render_system_template(name, prompt_args, return_json=True)" title="Direct link to render_system_template(name, prompt_args, return_json=True)">​</a></h4>
<ul>
<li><strong>Return type:</strong>
<code>ChatMessage</code></li>
<li><strong>Parameters:</strong>
<ul>
<li><strong>name</strong> (<em>str</em>)</li>
<li><strong>prompt_args</strong> (<em>PromptArgument</em>)</li>
<li><strong>return_json</strong> (<em>bool</em>)</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="render_user_templatename-prompt_args-message_typemessagetypeconversation">render_user_template(name, prompt_args, message_type=MessageType.CONVERSATION)<a href="#render_user_templatename-prompt_args-message_typemessagetypeconversation" class="hash-link" aria-label="Direct link to render_user_template(name, prompt_args, message_type=MessageType.CONVERSATION)" title="Direct link to render_user_template(name, prompt_args, message_type=MessageType.CONVERSATION)">​</a></h4>
<ul>
<li><strong>Return type:</strong>
<code>ChatMessage</code></li>
<li><strong>Parameters:</strong>
<ul>
<li><strong>name</strong> (<em>str</em>)</li>
<li><strong>prompt_args</strong> (<em>PromptArgument</em>)</li>
<li><strong>message_type</strong> (<em>MessageType</em>)</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="class-diskurspromptpromptloadermixin"><em>class</em> diskurs.prompt.PromptLoaderMixin<a href="#class-diskurspromptpromptloadermixin" class="hash-link" aria-label="Direct link to class-diskurspromptpromptloadermixin" title="Direct link to class-diskurspromptpromptloadermixin">​</a></h3>
<p>Bases: <code>object</code></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="classmethod-prepare_createagent_description_filename-code_filename-kwargs-location-system_prompt_argument_class-system_template_filename-user_prompt_argument_class-user_template_filename"><em>classmethod</em> prepare_create(agent_description_filename, code_filename, kwargs, location, system_prompt_argument_class, system_template_filename, user_prompt_argument_class, user_template_filename)<a href="#classmethod-prepare_createagent_description_filename-code_filename-kwargs-location-system_prompt_argument_class-system_template_filename-user_prompt_argument_class-user_template_filename" class="hash-link" aria-label="Direct link to classmethod-prepare_createagent_description_filename-code_filename-kwargs-location-system_prompt_argument_class-system_template_filename-user_prompt_argument_class-user_template_filename" title="Direct link to classmethod-prepare_createagent_description_filename-code_filename-kwargs-location-system_prompt_argument_class-system_template_filename-user_prompt_argument_class-user_template_filename">​</a></h4>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="classmethod-load_prompt_functionssystem_prompt_argument_class-user_prompt_argument_class-loaded_module-kwargs"><em>classmethod</em> load_prompt_functions(system_prompt_argument_class, user_prompt_argument_class, loaded_module, kwargs)<a href="#classmethod-load_prompt_functionssystem_prompt_argument_class-user_prompt_argument_class-loaded_module-kwargs" class="hash-link" aria-label="Direct link to classmethod-load_prompt_functionssystem_prompt_argument_class-user_prompt_argument_class-loaded_module-kwargs" title="Direct link to classmethod-load_prompt_functionssystem_prompt_argument_class-user_prompt_argument_class-loaded_module-kwargs">​</a></h4>
<ul>
<li><strong>Return type:</strong>
<code>dict</code>[<code>str</code>, <code>Callable</code>]</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="classmethod-load_user_assetsagent_description_filename-code_filename-location-system_template_filename-user_template_filename"><em>classmethod</em> load_user_assets(agent_description_filename, code_filename, location, system_template_filename, user_template_filename)<a href="#classmethod-load_user_assetsagent_description_filename-code_filename-location-system_template_filename-user_template_filename" class="hash-link" aria-label="Direct link to classmethod-load_user_assetsagent_description_filename-code_filename-location-system_template_filename-user_template_filename" title="Direct link to classmethod-load_user_assetsagent_description_filename-code_filename-location-system_template_filename-user_template_filename">​</a></h4>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="class-diskurspromptmultisteppromptagent_description-system_template-user_template-system_prompt_argument_class-user_prompt_argument_class-json_formatting_templatenone-is_validnone-is_finalnone"><em>class</em> diskurs.prompt.MultistepPrompt(agent_description, system_template, user_template, system_prompt_argument_class, user_prompt_argument_class, json_formatting_template=None, is_valid=None, is_final=None)<a href="#class-diskurspromptmultisteppromptagent_description-system_template-user_template-system_prompt_argument_class-user_prompt_argument_class-json_formatting_templatenone-is_validnone-is_finalnone" class="hash-link" aria-label="Direct link to class-diskurspromptmultisteppromptagent_description-system_template-user_template-system_prompt_argument_class-user_prompt_argument_class-json_formatting_templatenone-is_validnone-is_finalnone" title="Direct link to class-diskurspromptmultisteppromptagent_description-system_template-user_template-system_prompt_argument_class-user_prompt_argument_class-json_formatting_templatenone-is_validnone-is_finalnone">​</a></h3>
<p>Bases: <a href="#diskurs.prompt.PromptRendererMixin"><code>PromptRendererMixin</code></a>, <a href="#diskurs.prompt.PromptParserMixin"><code>PromptParserMixin</code></a>, <a href="#diskurs.prompt.PromptLoaderMixin"><code>PromptLoaderMixin</code></a>, <a href="/diskurs/docs/protocols#diskurs.protocols.MultistepPrompt"><code>MultistepPrompt</code></a></p>
<ul>
<li><strong>Parameters:</strong>
<ul>
<li><strong>agent_description</strong> (<em>str</em>)</li>
<li><strong>system_template</strong> (<em>Template</em>)</li>
<li><strong>user_template</strong> (<em>Template</em>)</li>
<li><strong>system_prompt_argument_class</strong> (<em>Type</em> *[*<em>SystemPromptArg</em> <em>]</em>)</li>
<li><strong>user_prompt_argument_class</strong> (<em>Type</em> *[*<em>UserPromptArg</em> <em>]</em>)</li>
<li><strong>json_formatting_template</strong> (<em>Template</em> <em>|</em> <em>None</em>)</li>
<li><strong>is_valid</strong> (<em>Callable</em> <em>[</em> *[*<em>Any</em> <em>]</em> <em>,</em> <em>bool</em> <em>]</em>  <em>|</em> <em>None</em>)</li>
<li><strong>is_final</strong> (<em>Callable</em> <em>[</em> *[*<em>Any</em> <em>]</em> <em>,</em> <em>bool</em> <em>]</em>  <em>|</em> <em>None</em>)</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="classmethod-createlocation-system_prompt_argument_class-user_prompt_argument_class-agent_description_filenameagent_descriptiontxt-code_filenamepromptpy-user_template_filenameuser_templatejinja2-system_template_filenamesystem_templatejinja2-kwargs"><em>classmethod</em> create(location, system_prompt_argument_class, user_prompt_argument_class, agent_description_filename=&#x27;agent_description.txt&#x27;, code_filename=&#x27;prompt.py&#x27;, user_template_filename=&#x27;user_template.jinja2&#x27;, system_template_filename=&#x27;system_template.jinja2&#x27;, **kwargs)<a href="#classmethod-createlocation-system_prompt_argument_class-user_prompt_argument_class-agent_description_filenameagent_descriptiontxt-code_filenamepromptpy-user_template_filenameuser_templatejinja2-system_template_filenamesystem_templatejinja2-kwargs" class="hash-link" aria-label="Direct link to classmethod-createlocation-system_prompt_argument_class-user_prompt_argument_class-agent_description_filenameagent_descriptiontxt-code_filenamepromptpy-user_template_filenameuser_templatejinja2-system_template_filenamesystem_templatejinja2-kwargs" title="Direct link to classmethod-createlocation-system_prompt_argument_class-user_prompt_argument_class-agent_description_filenameagent_descriptiontxt-code_filenamepromptpy-user_template_filenameuser_templatejinja2-system_template_filenamesystem_templatejinja2-kwargs">​</a></h4>
<p>Factory method to create a Prompt object. Loads templates and code dynamically
based on the provided directory and filenames.</p>
<ul>
<li><strong>Parameters:</strong>
<ul>
<li><strong>location</strong> (<code>Path</code>) – Base path where prompt.py and templates are located.</li>
<li><strong>system_prompt_argument_class</strong> (<code>str</code>) – Name of the class that specifies the placeholders of the system prompt template</li>
<li><strong>user_prompt_argument_class</strong> (<code>str</code>) – Name of the class that specifies the placeholders of the user prompt template</li>
<li><strong>agent_description_filename</strong> (<code>str</code>) – location of the text file containing the agent’s description</li>
<li><strong>code_filename</strong> (<code>str</code>) – Name of the file containing PromptArguments and validation logic.</li>
<li><strong>user_template_filename</strong> (<code>str</code>) – Filename of the user template (Jinja2 format).</li>
<li><strong>system_template_filename</strong> (<code>str</code>) – Filename of the system template (Jinja2 format).</li>
</ul>
</li>
<li><strong>Return type:</strong>
<code>Self</code></li>
<li><strong>Returns:</strong>
An instance of the Prompt class.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="classmethod-load_prompt_functionssystem_prompt_argument_class-user_prompt_argument_class-loaded_module-kwargs-1"><em>classmethod</em> load_prompt_functions(system_prompt_argument_class, user_prompt_argument_class, loaded_module, kwargs)<a href="#classmethod-load_prompt_functionssystem_prompt_argument_class-user_prompt_argument_class-loaded_module-kwargs-1" class="hash-link" aria-label="Direct link to classmethod-load_prompt_functionssystem_prompt_argument_class-user_prompt_argument_class-loaded_module-kwargs-1" title="Direct link to classmethod-load_prompt_functionssystem_prompt_argument_class-user_prompt_argument_class-loaded_module-kwargs-1">​</a></h4>
<ul>
<li><strong>Return type:</strong>
<code>dict</code>[<code>str</code>, <code>Callable</code>]</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="render_user_templatename-prompt_args-message_typemessagetypeconversation-1">render_user_template(name, prompt_args, message_type=MessageType.CONVERSATION)<a href="#render_user_templatename-prompt_args-message_typemessagetypeconversation-1" class="hash-link" aria-label="Direct link to render_user_template(name, prompt_args, message_type=MessageType.CONVERSATION)" title="Direct link to render_user_template(name, prompt_args, message_type=MessageType.CONVERSATION)">​</a></h4>
<p>Renders the user template with the provided prompt arguments.</p>
<p>This method is responsible for rendering the user template using the given prompt arguments.
It generates a ChatMessage object that represents the rendered template.</p>
<ul>
<li><strong>Parameters:</strong>
<ul>
<li><strong>name</strong> (<code>str</code>) – The name of the template to be rendered.</li>
<li><strong>prompt_args</strong> (<code>PromptArgument</code>) – The prompt arguments to be used for rendering the template.</li>
<li><strong>message_type</strong> (<code>MessageType</code>) – The type of the message to be rendered. Defaults to MessageType.CONVERSATION.</li>
</ul>
</li>
<li><strong>Return type:</strong>
<code>ChatMessage</code></li>
<li><strong>Returns:</strong>
A ChatMessage object containing the rendered template.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create_system_prompt_argumentprompt_args-1">create_system_prompt_argument(**prompt_args)<a href="#create_system_prompt_argumentprompt_args-1" class="hash-link" aria-label="Direct link to create_system_prompt_argument(**prompt_args)" title="Direct link to create_system_prompt_argument(**prompt_args)">​</a></h4>
<p>Creates an instance of the system prompt argument dataclass.</p>
<p>This method is responsible for generating the system prompt argument
based on the provided keyword arguments. The system prompt argument
is used to configure the initial state and context for the conversation.</p>
<ul>
<li><strong>Parameters:</strong>
<strong>prompt_args</strong> (<code>dict</code>) – Keyword arguments used to initialize the system prompt argument.</li>
<li><strong>Return type:</strong>
<code>TypeVar</code>(<code>SystemPromptArg</code>)</li>
<li><strong>Returns:</strong>
An instance of the system prompt argument dataclass.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create_user_prompt_argumentprompt_args-1">create_user_prompt_argument(**prompt_args)<a href="#create_user_prompt_argumentprompt_args-1" class="hash-link" aria-label="Direct link to create_user_prompt_argument(**prompt_args)" title="Direct link to create_user_prompt_argument(**prompt_args)">​</a></h4>
<p>Creates an instance of the user prompt argument dataclass.</p>
<p>This method is responsible for generating the user prompt argument
based on the provided keyword arguments. The user prompt argument
is used to configure the user’s input and context for the conversation.</p>
<ul>
<li><strong>Parameters:</strong>
<strong>prompt_args</strong> (<code>dict</code>) – Keyword arguments used to initialize the user prompt argument.</li>
<li><strong>Return type:</strong>
<code>TypeVar</code>(<code>UserPromptArg</code>)</li>
<li><strong>Returns:</strong>
An instance of the user prompt argument dataclass.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="is_finaluser_prompt_argument-1">is_final(user_prompt_argument)<a href="#is_finaluser_prompt_argument-1" class="hash-link" aria-label="Direct link to is_final(user_prompt_argument)" title="Direct link to is_final(user_prompt_argument)">​</a></h4>
<p>Determines if the user prompt argument indicates the final state.</p>
<p>This method checks the provided user prompt argument to determine if it represents
the final state in the conversation. It is used to decide whether the conversation
can be concluded based on the user’s input.</p>
<ul>
<li><strong>Parameters:</strong>
<strong>user_prompt_argument</strong> (<code>PromptArgument</code>) – The user prompt argument to be evaluated.</li>
<li><strong>Return type:</strong>
<code>bool</code></li>
<li><strong>Returns:</strong>
True if the user prompt argument indicates the final state, False otherwise.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="is_validuser_prompt_argument-1">is_valid(user_prompt_argument)<a href="#is_validuser_prompt_argument-1" class="hash-link" aria-label="Direct link to is_valid(user_prompt_argument)" title="Direct link to is_valid(user_prompt_argument)">​</a></h4>
<p>Validates the user prompt argument.</p>
<p>This method checks if the provided user prompt argument meets the required
criteria for validity. It ensures that the user prompt argument is correctly
structured and contains the necessary information for further processing.</p>
<ul>
<li><strong>Parameters:</strong>
<strong>user_prompt_argument</strong> (<code>PromptArgument</code>) – The user prompt argument to be validated.</li>
<li><strong>Return type:</strong>
<code>bool</code></li>
<li><strong>Returns:</strong>
True if the user prompt argument is valid, False otherwise.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="classmethod-load_user_assetsagent_description_filename-code_filename-location-system_template_filename-user_template_filename-1"><em>classmethod</em> load_user_assets(agent_description_filename, code_filename, location, system_template_filename, user_template_filename)<a href="#classmethod-load_user_assetsagent_description_filename-code_filename-location-system_template_filename-user_template_filename-1" class="hash-link" aria-label="Direct link to classmethod-load_user_assetsagent_description_filename-code_filename-location-system_template_filename-user_template_filename-1" title="Direct link to classmethod-load_user_assetsagent_description_filename-code_filename-location-system_template_filename-user_template_filename-1">​</a></h4>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="parse_user_promptllm_response-old_user_prompt_argument-message_typemessagetyperouting-1">parse_user_prompt(llm_response, old_user_prompt_argument, message_type=MessageType.ROUTING)<a href="#parse_user_promptllm_response-old_user_prompt_argument-message_typemessagetyperouting-1" class="hash-link" aria-label="Direct link to parse_user_prompt(llm_response, old_user_prompt_argument, message_type=MessageType.ROUTING)" title="Direct link to parse_user_prompt(llm_response, old_user_prompt_argument, message_type=MessageType.ROUTING)">​</a></h4>
<p>Parse the text returned from the LLM into a structured prompt argument.
First validate the text, then parse it into the prompt argument.
If the text is not valid, raise a PromptValidationError, and generate a user prompt with the error message,
for the LLM to correct its output.</p>
<ul>
<li><strong>Parameters:</strong>
<ul>
<li><strong>llm_response</strong> (<code>str</code>) – Response from the LLM.</li>
<li><strong>old_user_prompt_argument</strong> (<em>PromptArgument</em>)</li>
<li><strong>message_type</strong> (<em>MessageType</em>)</li>
</ul>
</li>
<li><strong>Return type:</strong>
<em>PromptArgument</em> | <em>ChatMessage</em></li>
</ul>
<p>:param<!-- --> old_user_prompt_argument
<!-- -->:type<!-- --> message_type: <code>MessageType</code>
<!-- -->:param<!-- --> message_type: Type of message to be created.
:rtype: <code>PromptArgument</code> | <code>ChatMessage</code>
:return: Validated prompt argument or a ChatMessage with an error message.
<!-- -->:raises<!-- --> PromptValidationError: If the text is not valid.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="classmethod-prepare_createagent_description_filename-code_filename-kwargs-location-system_prompt_argument_class-system_template_filename-user_prompt_argument_class-user_template_filename-1"><em>classmethod</em> prepare_create(agent_description_filename, code_filename, kwargs, location, system_prompt_argument_class, system_template_filename, user_prompt_argument_class, user_template_filename)<a href="#classmethod-prepare_createagent_description_filename-code_filename-kwargs-location-system_prompt_argument_class-system_template_filename-user_prompt_argument_class-user_template_filename-1" class="hash-link" aria-label="Direct link to classmethod-prepare_createagent_description_filename-code_filename-kwargs-location-system_prompt_argument_class-system_template_filename-user_prompt_argument_class-user_template_filename-1" title="Direct link to classmethod-prepare_createagent_description_filename-code_filename-kwargs-location-system_prompt_argument_class-system_template_filename-user_prompt_argument_class-user_template_filename-1">​</a></h4>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="render_json_formatting_promptprompt_args-1">render_json_formatting_prompt(prompt_args)<a href="#render_json_formatting_promptprompt_args-1" class="hash-link" aria-label="Direct link to render_json_formatting_prompt(prompt_args)" title="Direct link to render_json_formatting_prompt(prompt_args)">​</a></h4>
<ul>
<li><strong>Return type:</strong>
<code>str</code></li>
<li><strong>Parameters:</strong>
<strong>prompt_args</strong> (<em>dict</em>)</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="render_system_templatename-prompt_args-return_jsontrue-1">render_system_template(name, prompt_args, return_json=True)<a href="#render_system_templatename-prompt_args-return_jsontrue-1" class="hash-link" aria-label="Direct link to render_system_template(name, prompt_args, return_json=True)" title="Direct link to render_system_template(name, prompt_args, return_json=True)">​</a></h4>
<p>Renders the system template with the provided prompt arguments.</p>
<p>This method is responsible for rendering the system template using the given prompt arguments.
It can optionally return the rendered template as a JSON object.</p>
<ul>
<li><strong>Parameters:</strong>
<ul>
<li><strong>name</strong> (<code>str</code>) – The name of the template to be rendered.</li>
<li><strong>prompt_args</strong> (<code>PromptArgument</code>) – The prompt arguments to be used for rendering the template.</li>
<li><strong>return_json</strong> (<code>bool</code>) – If True, the rendered template will be returned as a JSON object. Defaults to True.</li>
</ul>
</li>
<li><strong>Return type:</strong>
<code>ChatMessage</code></li>
<li><strong>Returns:</strong>
A ChatMessage object containing the rendered template.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="classmethod-validate_dataclassparsed_response-user_prompt_argument-strictfalse-1"><em>classmethod</em> validate_dataclass(parsed_response, user_prompt_argument, strict=False)<a href="#classmethod-validate_dataclassparsed_response-user_prompt_argument-strictfalse-1" class="hash-link" aria-label="Direct link to classmethod-validate_dataclassparsed_response-user_prompt_argument-strictfalse-1" title="Direct link to classmethod-validate_dataclassparsed_response-user_prompt_argument-strictfalse-1">​</a></h4>
<p>Validate that the JSON fields match the target dataclass.
In strict mode, all fields must be present. If not strict, all required fields (without default values)
must be present at minimum.</p>
<ul>
<li><strong>Parameters:</strong>
<ul>
<li><strong>parsed_response</strong> (<code>dict</code>[<code>str</code>, <code>Any</code>]) – Dictionary representing the LLM’s response.</li>
<li><strong>user_prompt_argument</strong> (<code>Type</code>[<code>dataclass</code>]) – The dataclass type to validate against.</li>
<li><strong>strict</strong> (<code>bool</code>) – If True, all fields must be present. If False, required fields must be present.</li>
</ul>
</li>
<li><strong>Return type:</strong>
<code>dataclass</code></li>
<li><strong>Returns:</strong>
An instance of the dataclass if validation succeeds.</li>
<li><strong>Raises:</strong>
LLMResponseParseError if validation fails.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="classmethod-validate_jsonllm_response-1"><em>classmethod</em> validate_json(llm_response)<a href="#classmethod-validate_jsonllm_response-1" class="hash-link" aria-label="Direct link to classmethod-validate_jsonllm_response-1" title="Direct link to classmethod-validate_jsonllm_response-1">​</a></h4>
<p>Parse and validate the LLM response as JSON, handling nested JSON strings.</p>
<ul>
<li><strong>Parameters:</strong>
<strong>llm_response</strong> (<code>str</code>) – The raw text response from the LLM.</li>
<li><strong>Return type:</strong>
<code>dict</code></li>
<li><strong>Returns:</strong>
Parsed dictionary if valid JSON.</li>
<li><strong>Raises:</strong>
<a href="#diskurs.prompt.PromptValidationError"><strong>PromptValidationError</strong></a> – If the response is not valid JSON.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="system_prompt_argument--typetypevarsystempromptarg">system_prompt_argument <em>: <code>Type</code>[<code>TypeVar</code>(<code>SystemPromptArg</code>)]</em><a href="#system_prompt_argument--typetypevarsystempromptarg" class="hash-link" aria-label="Direct link to system_prompt_argument--typetypevarsystempromptarg" title="Direct link to system_prompt_argument--typetypevarsystempromptarg">​</a></h4>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="user_prompt_argument--typetypevaruserpromptarg">user_prompt_argument <em>: <code>Type</code>[<code>TypeVar</code>(<code>UserPromptArg</code>)]</em><a href="#user_prompt_argument--typetypevaruserpromptarg" class="hash-link" aria-label="Direct link to user_prompt_argument--typetypevaruserpromptarg" title="Direct link to user_prompt_argument--typetypevaruserpromptarg">​</a></h4>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="class-diskurspromptconductorpromptagent_description-system_template-user_template-system_prompt_argument_class-user_prompt_argument_class-json_formatting_templatenone-longterm_memory_classnone-can_finalizenone-finalizenone-failnone-topicsnone"><em>class</em> diskurs.prompt.ConductorPrompt(agent_description, system_template, user_template, system_prompt_argument_class, user_prompt_argument_class, json_formatting_template=None, longterm_memory_class=None, can_finalize=None, finalize=None, fail=None, topics=None)<a href="#class-diskurspromptconductorpromptagent_description-system_template-user_template-system_prompt_argument_class-user_prompt_argument_class-json_formatting_templatenone-longterm_memory_classnone-can_finalizenone-finalizenone-failnone-topicsnone" class="hash-link" aria-label="Direct link to class-diskurspromptconductorpromptagent_description-system_template-user_template-system_prompt_argument_class-user_prompt_argument_class-json_formatting_templatenone-longterm_memory_classnone-can_finalizenone-finalizenone-failnone-topicsnone" title="Direct link to class-diskurspromptconductorpromptagent_description-system_template-user_template-system_prompt_argument_class-user_prompt_argument_class-json_formatting_templatenone-longterm_memory_classnone-can_finalizenone-finalizenone-failnone-topicsnone">​</a></h3>
<p>Bases: <a href="#diskurs.prompt.PromptRendererMixin"><code>PromptRendererMixin</code></a>, <a href="#diskurs.prompt.PromptParserMixin"><code>PromptParserMixin</code></a>, <a href="#diskurs.prompt.PromptLoaderMixin"><code>PromptLoaderMixin</code></a>, <a href="/diskurs/docs/protocols#diskurs.protocols.ConductorPrompt"><code>ConductorPrompt</code></a></p>
<ul>
<li><strong>Parameters:</strong>
<ul>
<li><strong>agent_description</strong> (<em>str</em>)</li>
<li><strong>system_template</strong> (<em>Template</em>)</li>
<li><strong>user_template</strong> (<em>Template</em>)</li>
<li><strong>system_prompt_argument_class</strong> (<em>Type</em> *[*<em>SystemPromptArg</em> <em>]</em>)</li>
<li><strong>user_prompt_argument_class</strong> (<em>Type</em> *[*<em>UserPromptArg</em> <em>]</em>)</li>
<li><strong>json_formatting_template</strong> (<em>Template</em> <em>|</em> <em>None</em>)</li>
<li><strong>longterm_memory_class</strong> (<em>Type</em> *[*<em>GenericConductorLongtermMemory</em> <em>]</em>)</li>
<li><strong>can_finalize</strong> (<em>Callable</em> <em>[</em> *[*<em>GenericConductorLongtermMemory</em> <em>]</em> <em>,</em> <em>bool</em> <em>]</em>)</li>
<li><strong>finalize</strong> (<em>Callable</em> <em>[</em> *[*<em>GenericConductorLongtermMemory</em> <em>]</em> <em>,</em> <em>dict</em> *[*<em>str</em> <em>,</em> <em>Any</em> <em>]</em> <em>]</em>)</li>
<li><strong>fail</strong> (<em>Callable</em> <em>[</em> *[*<em>GenericConductorLongtermMemory</em> <em>]</em> <em>,</em> <em>dict</em> *[*<em>str</em> <em>,</em> <em>Any</em> <em>]</em> <em>]</em>)</li>
<li><strong>topics</strong> (<em>list</em> *[*<em>str</em> <em>]</em>)</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="longterm_memory--typelongtermmemory">longterm_memory <em>: Type[LongtermMemory]</em><a href="#longterm_memory--typelongtermmemory" class="hash-link" aria-label="Direct link to longterm_memory--typelongtermmemory" title="Direct link to longterm_memory--typelongtermmemory">​</a></h4>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="static-create_default_is_validtopics"><em>static</em> create_default_is_valid(topics)<a href="#static-create_default_is_validtopics" class="hash-link" aria-label="Direct link to static-create_default_is_validtopics" title="Direct link to static-create_default_is_validtopics">​</a></h4>
<ul>
<li><strong>Return type:</strong>
<code>Callable</code>[[<code>TypeVar</code>(<code>UserPromptArg</code>)], <code>bool</code>]</li>
<li><strong>Parameters:</strong>
<strong>topics</strong> (<em>list</em> *[*<em>str</em> <em>]</em>)</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="static-create_default_is_finaltopics"><em>static</em> create_default_is_final(topics)<a href="#static-create_default_is_finaltopics" class="hash-link" aria-label="Direct link to static-create_default_is_finaltopics" title="Direct link to static-create_default_is_finaltopics">​</a></h4>
<ul>
<li><strong>Return type:</strong>
<code>Callable</code>[[<code>TypeVar</code>(<code>UserPromptArg</code>)], <code>bool</code>]</li>
<li><strong>Parameters:</strong>
<strong>topics</strong> (<em>list</em> *[*<em>str</em> <em>]</em>)</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="classmethod-createlocation-system_prompt_argument_class-user_prompt_argument_classnone-agent_description_filenameagent_descriptiontxt-code_filenamepromptpy-user_template_filenamenone-system_template_filenamenone-kwargs"><em>classmethod</em> create(location, system_prompt_argument_class, user_prompt_argument_class=None, agent_description_filename=&#x27;agent_description.txt&#x27;, code_filename=&#x27;prompt.py&#x27;, user_template_filename=None, system_template_filename=None, **kwargs)<a href="#classmethod-createlocation-system_prompt_argument_class-user_prompt_argument_classnone-agent_description_filenameagent_descriptiontxt-code_filenamepromptpy-user_template_filenamenone-system_template_filenamenone-kwargs" class="hash-link" aria-label="Direct link to classmethod-createlocation-system_prompt_argument_class-user_prompt_argument_classnone-agent_description_filenameagent_descriptiontxt-code_filenamepromptpy-user_template_filenamenone-system_template_filenamenone-kwargs" title="Direct link to classmethod-createlocation-system_prompt_argument_class-user_prompt_argument_classnone-agent_description_filenameagent_descriptiontxt-code_filenamepromptpy-user_template_filenamenone-system_template_filenamenone-kwargs">​</a></h4>
<ul>
<li><strong>Return type:</strong>
<a href="#diskurs.prompt.ConductorPrompt"><code>ConductorPrompt</code></a></li>
<li><strong>Parameters:</strong>
<ul>
<li><strong>location</strong> (<em>Path</em>)</li>
<li><strong>system_prompt_argument_class</strong> (<em>str</em>)</li>
<li><strong>user_prompt_argument_class</strong> (<em>str</em> <em>|</em> <em>None</em>)</li>
<li><strong>agent_description_filename</strong> (<em>str</em> <em>|</em> <em>None</em>)</li>
<li><strong>code_filename</strong> (<em>str</em>)</li>
<li><strong>user_template_filename</strong> (<em>str</em> <em>|</em> <em>None</em>)</li>
<li><strong>system_template_filename</strong> (<em>str</em> <em>|</em> <em>None</em>)</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="classmethod-load_prompt_functionssystem_prompt_argument_class-user_prompt_argument_class-loaded_module-kwargs-2"><em>classmethod</em> load_prompt_functions(system_prompt_argument_class, user_prompt_argument_class, loaded_module, kwargs)<a href="#classmethod-load_prompt_functionssystem_prompt_argument_class-user_prompt_argument_class-loaded_module-kwargs-2" class="hash-link" aria-label="Direct link to classmethod-load_prompt_functionssystem_prompt_argument_class-user_prompt_argument_class-loaded_module-kwargs-2" title="Direct link to classmethod-load_prompt_functionssystem_prompt_argument_class-user_prompt_argument_class-loaded_module-kwargs-2">​</a></h4>
<ul>
<li><strong>Return type:</strong>
<code>dict</code>[<code>str</code>, <code>Callable</code>]</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="can_finalizelongterm_memory">can_finalize(longterm_memory)<a href="#can_finalizelongterm_memory" class="hash-link" aria-label="Direct link to can_finalize(longterm_memory)" title="Direct link to can_finalize(longterm_memory)">​</a></h4>
<p>Determines if the conductor can finalize based on the long-term memory.</p>
<p>This method evaluates the provided long-term memory to decide whether the
conversation can be concluded. It checks if the necessary conditions are met
for finalizing the conversation.</p>
<ul>
<li><strong>Parameters:</strong>
<strong>longterm_memory</strong> (<code>TypeVar</code>(<code>GenericConductorLongtermMemory</code>, bound= ConductorLongtermMemory)) – The long-term memory to be evaluated.</li>
<li><strong>Return type:</strong>
<code>bool</code></li>
<li><strong>Returns:</strong>
True if the conversation can be finalized, False otherwise.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="finalizelongterm_memory">finalize(longterm_memory)<a href="#finalizelongterm_memory" class="hash-link" aria-label="Direct link to finalize(longterm_memory)" title="Direct link to finalize(longterm_memory)">​</a></h4>
<p>Finalizes the conversation based on the long-term memory.</p>
<p>This method processes the provided long-term memory to generate a final response
for the conversation. It is responsible for concluding the conversation by
utilizing the accumulated long-term memory data.</p>
<ul>
<li><strong>Parameters:</strong>
<strong>longterm_memory</strong> (<code>TypeVar</code>(<code>GenericConductorLongtermMemory</code>, bound= ConductorLongtermMemory)) – The long-term memory to be used for finalizing the conversation.</li>
<li><strong>Return type:</strong>
<code>TypeVar</code>(<code>GenericConductorLongtermMemory</code>, bound= ConductorLongtermMemory)</li>
<li><strong>Returns:</strong>
A dictionary containing the final response data.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="faillongterm_memory">fail(longterm_memory)<a href="#faillongterm_memory" class="hash-link" aria-label="Direct link to fail(longterm_memory)" title="Direct link to fail(longterm_memory)">​</a></h4>
<p>Handles the case failure i.e. when the long-term memory does not meet the criteria defined
for finalization.</p>
<p>This method processes the provided long-term memory to generate a failure response
for the conversation. It is responsible for concluding the conversation in a failure
state by utilizing the accumulated long-term memory data.</p>
<ul>
<li><strong>Parameters:</strong>
<strong>longterm_memory</strong> (<code>TypeVar</code>(<code>GenericConductorLongtermMemory</code>, bound= ConductorLongtermMemory)) – The long-term memory to be used for generating the failure response.</li>
<li><strong>Return type:</strong>
<code>TypeVar</code>(<code>GenericConductorLongtermMemory</code>, bound= ConductorLongtermMemory)</li>
<li><strong>Returns:</strong>
A dictionary containing the failure response data.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="init_longterm_memorykwargs">init_longterm_memory(**kwargs)<a href="#init_longterm_memorykwargs" class="hash-link" aria-label="Direct link to init_longterm_memory(**kwargs)" title="Direct link to init_longterm_memory(**kwargs)">​</a></h4>
<p>Initializes the long-term memory.</p>
<p>This method is responsible for creating and initializing the long-term memory
for the conductor agent. It uses the provided keyword arguments to set up the
initial state of the long-term memory.</p>
<ul>
<li><strong>Parameters:</strong>
<strong>kwargs</strong> – Keyword arguments used to initialize the long-term memory.</li>
<li><strong>Return type:</strong>
<code>TypeVar</code>(<code>GenericConductorLongtermMemory</code>, bound= ConductorLongtermMemory)</li>
<li><strong>Returns:</strong>
An instance of the LongtermMemory class.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="render_user_templatename-prompt_args-message_typemessagetypeconversation-2">render_user_template(name, prompt_args, message_type=MessageType.CONVERSATION)<a href="#render_user_templatename-prompt_args-message_typemessagetypeconversation-2" class="hash-link" aria-label="Direct link to render_user_template(name, prompt_args, message_type=MessageType.CONVERSATION)" title="Direct link to render_user_template(name, prompt_args, message_type=MessageType.CONVERSATION)">​</a></h4>
<p>Renders the user template with the provided prompt arguments.</p>
<p>This method is responsible for rendering the user template using the given prompt arguments.
It generates a ChatMessage object that represents the rendered template.</p>
<ul>
<li><strong>Parameters:</strong>
<ul>
<li><strong>name</strong> (<code>str</code>) – The name of the template to be rendered.</li>
<li><strong>prompt_args</strong> (<code>PromptArgument</code>) – The prompt arguments to be used for rendering the template.</li>
<li><strong>message_type</strong> (<code>MessageType</code>) – The type of the message to be rendered. Defaults to MessageType.CONVERSATION.</li>
</ul>
</li>
<li><strong>Return type:</strong>
<code>ChatMessage</code></li>
<li><strong>Returns:</strong>
A ChatMessage object containing the rendered template.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create_system_prompt_argumentprompt_args-2">create_system_prompt_argument(**prompt_args)<a href="#create_system_prompt_argumentprompt_args-2" class="hash-link" aria-label="Direct link to create_system_prompt_argument(**prompt_args)" title="Direct link to create_system_prompt_argument(**prompt_args)">​</a></h4>
<p>Creates an instance of the system prompt argument dataclass.</p>
<p>This method is responsible for generating the system prompt argument
based on the provided keyword arguments. The system prompt argument
is used to configure the initial state and context for the conversation.</p>
<ul>
<li><strong>Parameters:</strong>
<strong>prompt_args</strong> (<code>dict</code>) – Keyword arguments used to initialize the system prompt argument.</li>
<li><strong>Return type:</strong>
<code>TypeVar</code>(<code>SystemPromptArg</code>)</li>
<li><strong>Returns:</strong>
An instance of the system prompt argument dataclass.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create_user_prompt_argumentprompt_args-2">create_user_prompt_argument(**prompt_args)<a href="#create_user_prompt_argumentprompt_args-2" class="hash-link" aria-label="Direct link to create_user_prompt_argument(**prompt_args)" title="Direct link to create_user_prompt_argument(**prompt_args)">​</a></h4>
<p>Creates an instance of the user prompt argument dataclass.</p>
<p>This method is responsible for generating the user prompt argument
based on the provided keyword arguments. The user prompt argument
is used to configure the user’s input and context for the conversation.</p>
<ul>
<li><strong>Parameters:</strong>
<strong>prompt_args</strong> (<code>dict</code>) – Keyword arguments used to initialize the user prompt argument.</li>
<li><strong>Return type:</strong>
<code>TypeVar</code>(<code>UserPromptArg</code>)</li>
<li><strong>Returns:</strong>
An instance of the user prompt argument dataclass.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="is_finaluser_prompt_argument-2">is_final(user_prompt_argument)<a href="#is_finaluser_prompt_argument-2" class="hash-link" aria-label="Direct link to is_final(user_prompt_argument)" title="Direct link to is_final(user_prompt_argument)">​</a></h4>
<p>Determines if the user prompt argument indicates the final state.</p>
<p>This method checks the provided user prompt argument to determine if it represents
the final state in the conversation. It is used to decide whether the conversation
can be concluded based on the user’s input.</p>
<ul>
<li><strong>Parameters:</strong>
<strong>user_prompt_argument</strong> (<code>PromptArgument</code>) – The user prompt argument to be evaluated.</li>
<li><strong>Return type:</strong>
<code>bool</code></li>
<li><strong>Returns:</strong>
True if the user prompt argument indicates the final state, False otherwise.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="is_validuser_prompt_argument-2">is_valid(user_prompt_argument)<a href="#is_validuser_prompt_argument-2" class="hash-link" aria-label="Direct link to is_valid(user_prompt_argument)" title="Direct link to is_valid(user_prompt_argument)">​</a></h4>
<p>Validates the user prompt argument.</p>
<p>This method checks if the provided user prompt argument meets the required
criteria for validity. It ensures that the user prompt argument is correctly
structured and contains the necessary information for further processing.</p>
<ul>
<li><strong>Parameters:</strong>
<strong>user_prompt_argument</strong> (<code>PromptArgument</code>) – The user prompt argument to be validated.</li>
<li><strong>Return type:</strong>
<code>bool</code></li>
<li><strong>Returns:</strong>
True if the user prompt argument is valid, False otherwise.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="classmethod-load_user_assetsagent_description_filename-code_filename-location-system_template_filename-user_template_filename-2"><em>classmethod</em> load_user_assets(agent_description_filename, code_filename, location, system_template_filename, user_template_filename)<a href="#classmethod-load_user_assetsagent_description_filename-code_filename-location-system_template_filename-user_template_filename-2" class="hash-link" aria-label="Direct link to classmethod-load_user_assetsagent_description_filename-code_filename-location-system_template_filename-user_template_filename-2" title="Direct link to classmethod-load_user_assetsagent_description_filename-code_filename-location-system_template_filename-user_template_filename-2">​</a></h4>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="parse_user_promptllm_response-old_user_prompt_argument-message_typemessagetyperouting-2">parse_user_prompt(llm_response, old_user_prompt_argument, message_type=MessageType.ROUTING)<a href="#parse_user_promptllm_response-old_user_prompt_argument-message_typemessagetyperouting-2" class="hash-link" aria-label="Direct link to parse_user_prompt(llm_response, old_user_prompt_argument, message_type=MessageType.ROUTING)" title="Direct link to parse_user_prompt(llm_response, old_user_prompt_argument, message_type=MessageType.ROUTING)">​</a></h4>
<p>Parse the text returned from the LLM into a structured prompt argument.
First validate the text, then parse it into the prompt argument.
If the text is not valid, raise a PromptValidationError, and generate a user prompt with the error message,
for the LLM to correct its output.</p>
<ul>
<li><strong>Parameters:</strong>
<ul>
<li><strong>llm_response</strong> (<code>str</code>) – Response from the LLM.</li>
<li><strong>old_user_prompt_argument</strong> (<em>PromptArgument</em>)</li>
<li><strong>message_type</strong> (<em>MessageType</em>)</li>
</ul>
</li>
<li><strong>Return type:</strong>
<em>PromptArgument</em> | <em>ChatMessage</em></li>
</ul>
<p>:param<!-- --> old_user_prompt_argument
<!-- -->:type<!-- --> message_type: <code>MessageType</code>
<!-- -->:param<!-- --> message_type: Type of message to be created.
:rtype: <code>PromptArgument</code> | <code>ChatMessage</code>
:return: Validated prompt argument or a ChatMessage with an error message.
<!-- -->:raises<!-- --> PromptValidationError: If the text is not valid.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="classmethod-prepare_createagent_description_filename-code_filename-kwargs-location-system_prompt_argument_class-system_template_filename-user_prompt_argument_class-user_template_filename-2"><em>classmethod</em> prepare_create(agent_description_filename, code_filename, kwargs, location, system_prompt_argument_class, system_template_filename, user_prompt_argument_class, user_template_filename)<a href="#classmethod-prepare_createagent_description_filename-code_filename-kwargs-location-system_prompt_argument_class-system_template_filename-user_prompt_argument_class-user_template_filename-2" class="hash-link" aria-label="Direct link to classmethod-prepare_createagent_description_filename-code_filename-kwargs-location-system_prompt_argument_class-system_template_filename-user_prompt_argument_class-user_template_filename-2" title="Direct link to classmethod-prepare_createagent_description_filename-code_filename-kwargs-location-system_prompt_argument_class-system_template_filename-user_prompt_argument_class-user_template_filename-2">​</a></h4>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="render_json_formatting_promptprompt_args-2">render_json_formatting_prompt(prompt_args)<a href="#render_json_formatting_promptprompt_args-2" class="hash-link" aria-label="Direct link to render_json_formatting_prompt(prompt_args)" title="Direct link to render_json_formatting_prompt(prompt_args)">​</a></h4>
<ul>
<li><strong>Return type:</strong>
<code>str</code></li>
<li><strong>Parameters:</strong>
<strong>prompt_args</strong> (<em>dict</em>)</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="render_system_templatename-prompt_args-return_jsontrue-2">render_system_template(name, prompt_args, return_json=True)<a href="#render_system_templatename-prompt_args-return_jsontrue-2" class="hash-link" aria-label="Direct link to render_system_template(name, prompt_args, return_json=True)" title="Direct link to render_system_template(name, prompt_args, return_json=True)">​</a></h4>
<p>Renders the system template with the provided prompt arguments.</p>
<p>This method is responsible for rendering the system template using the given prompt arguments.
It can optionally return the rendered template as a JSON object.</p>
<ul>
<li><strong>Parameters:</strong>
<ul>
<li><strong>name</strong> (<code>str</code>) – The name of the template to be rendered.</li>
<li><strong>prompt_args</strong> (<code>PromptArgument</code>) – The prompt arguments to be used for rendering the template.</li>
<li><strong>return_json</strong> (<code>bool</code>) – If True, the rendered template will be returned as a JSON object. Defaults to True.</li>
</ul>
</li>
<li><strong>Return type:</strong>
<code>ChatMessage</code></li>
<li><strong>Returns:</strong>
A ChatMessage object containing the rendered template.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="classmethod-validate_dataclassparsed_response-user_prompt_argument-strictfalse-2"><em>classmethod</em> validate_dataclass(parsed_response, user_prompt_argument, strict=False)<a href="#classmethod-validate_dataclassparsed_response-user_prompt_argument-strictfalse-2" class="hash-link" aria-label="Direct link to classmethod-validate_dataclassparsed_response-user_prompt_argument-strictfalse-2" title="Direct link to classmethod-validate_dataclassparsed_response-user_prompt_argument-strictfalse-2">​</a></h4>
<p>Validate that the JSON fields match the target dataclass.
In strict mode, all fields must be present. If not strict, all required fields (without default values)
must be present at minimum.</p>
<ul>
<li><strong>Parameters:</strong>
<ul>
<li><strong>parsed_response</strong> (<code>dict</code>[<code>str</code>, <code>Any</code>]) – Dictionary representing the LLM’s response.</li>
<li><strong>user_prompt_argument</strong> (<code>Type</code>[<code>dataclass</code>]) – The dataclass type to validate against.</li>
<li><strong>strict</strong> (<code>bool</code>) – If True, all fields must be present. If False, required fields must be present.</li>
</ul>
</li>
<li><strong>Return type:</strong>
<code>dataclass</code></li>
<li><strong>Returns:</strong>
An instance of the dataclass if validation succeeds.</li>
<li><strong>Raises:</strong>
LLMResponseParseError if validation fails.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="classmethod-validate_jsonllm_response-2"><em>classmethod</em> validate_json(llm_response)<a href="#classmethod-validate_jsonllm_response-2" class="hash-link" aria-label="Direct link to classmethod-validate_jsonllm_response-2" title="Direct link to classmethod-validate_jsonllm_response-2">​</a></h4>
<p>Parse and validate the LLM response as JSON, handling nested JSON strings.</p>
<ul>
<li><strong>Parameters:</strong>
<strong>llm_response</strong> (<code>str</code>) – The raw text response from the LLM.</li>
<li><strong>Return type:</strong>
<code>dict</code></li>
<li><strong>Returns:</strong>
Parsed dictionary if valid JSON.</li>
<li><strong>Raises:</strong>
<a href="#diskurs.prompt.PromptValidationError"><strong>PromptValidationError</strong></a> – If the response is not valid JSON.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="system_prompt_argument--typesystempromptarg">system_prompt_argument <em>: Type[SystemPromptArg]</em><a href="#system_prompt_argument--typesystempromptarg" class="hash-link" aria-label="Direct link to system_prompt_argument--typesystempromptarg" title="Direct link to system_prompt_argument--typesystempromptarg">​</a></h4>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="user_prompt_argument--typeuserpromptarg">user_prompt_argument <em>: Type[UserPromptArg]</em><a href="#user_prompt_argument--typeuserpromptarg" class="hash-link" aria-label="Direct link to user_prompt_argument--typeuserpromptarg" title="Direct link to user_prompt_argument--typeuserpromptarg">​</a></h4>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="class-diskurspromptheuristicpromptuser_prompt_argument_class-heuristic_sequence-user_templatenone-agent_description"><em>class</em> diskurs.prompt.HeuristicPrompt(user_prompt_argument_class, heuristic_sequence, user_template=None, agent_description=&#x27;&#x27;)<a href="#class-diskurspromptheuristicpromptuser_prompt_argument_class-heuristic_sequence-user_templatenone-agent_description" class="hash-link" aria-label="Direct link to class-diskurspromptheuristicpromptuser_prompt_argument_class-heuristic_sequence-user_templatenone-agent_description" title="Direct link to class-diskurspromptheuristicpromptuser_prompt_argument_class-heuristic_sequence-user_templatenone-agent_description">​</a></h3>
<p>Bases: <a href="/diskurs/docs/protocols#diskurs.protocols.HeuristicPrompt"><code>HeuristicPrompt</code></a></p>
<ul>
<li><strong>Parameters:</strong>
<ul>
<li><strong>user_prompt_argument_class</strong> (<em>Type</em> *[*<em>PromptArgument</em> <em>]</em>)</li>
<li><strong>heuristic_sequence</strong> (<a href="/diskurs/docs/protocols#diskurs.protocols.HeuristicSequence"><em>HeuristicSequence</em></a>)</li>
<li><strong>user_template</strong> (<em>Template</em> <em>|</em> <em>None</em>)</li>
<li><strong>agent_description</strong> (<em>str</em> <em>|</em> <em>None</em>)</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="user_prompt_argument--typepromptargument">user_prompt_argument <em>: <code>Type</code>[<code>PromptArgument</code>]</em><a href="#user_prompt_argument--typepromptargument" class="hash-link" aria-label="Direct link to user_prompt_argument--typepromptargument" title="Direct link to user_prompt_argument--typepromptargument">​</a></h4>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="classmethod-createlocation-user_prompt_argument_class-agent_description_filenameagent_descriptiontxt-user_template_filenameuser_templatejinja2-code_filenamepromptpy-heuristic_sequence_nameheuristic_sequence-kwargs"><em>classmethod</em> create(location, user_prompt_argument_class, agent_description_filename=&#x27;agent_description.txt&#x27;, user_template_filename=&#x27;user_template.jinja2&#x27;, code_filename=&#x27;prompt.py&#x27;, heuristic_sequence_name=&#x27;heuristic_sequence&#x27;, **kwargs)<a href="#classmethod-createlocation-user_prompt_argument_class-agent_description_filenameagent_descriptiontxt-user_template_filenameuser_templatejinja2-code_filenamepromptpy-heuristic_sequence_nameheuristic_sequence-kwargs" class="hash-link" aria-label="Direct link to classmethod-createlocation-user_prompt_argument_class-agent_description_filenameagent_descriptiontxt-user_template_filenameuser_templatejinja2-code_filenamepromptpy-heuristic_sequence_nameheuristic_sequence-kwargs" title="Direct link to classmethod-createlocation-user_prompt_argument_class-agent_description_filenameagent_descriptiontxt-user_template_filenameuser_templatejinja2-code_filenamepromptpy-heuristic_sequence_nameheuristic_sequence-kwargs">​</a></h4>
<ul>
<li><strong>Return type:</strong>
<code>Self</code></li>
<li><strong>Parameters:</strong>
<ul>
<li><strong>location</strong> (<em>Path</em>)</li>
<li><strong>user_prompt_argument_class</strong> (<em>str</em>)</li>
<li><strong>agent_description_filename</strong> (<em>str</em>)</li>
<li><strong>user_template_filename</strong> (<em>str</em>)</li>
<li><strong>code_filename</strong> (<em>str</em>)</li>
<li><strong>heuristic_sequence_name</strong> (<em>str</em>)</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="heuristic_sequenceconversation-call_toolnone">heuristic_sequence(conversation, call_tool=None)<a href="#heuristic_sequenceconversation-call_toolnone" class="hash-link" aria-label="Direct link to heuristic_sequence(conversation, call_tool=None)" title="Direct link to heuristic_sequence(conversation, call_tool=None)">​</a></h4>
<p>Executes a heuristic sequence on the given conversation.</p>
<p>This method processes the conversation using a series of heuristic steps,
optionally utilizing a tool for specific operations. The heuristic sequence
is designed to guide the conversation towards a desired outcome based on
predefined rules and logic.</p>
<ul>
<li><strong>Parameters:</strong>
<ul>
<li><strong>conversation</strong> (<a href="/diskurs/docs/protocols#diskurs.protocols.Conversation"><code>Conversation</code></a>) – The conversation object to be processed.</li>
<li><strong>call_tool</strong> (<code>Optional</code>[<a href="/diskurs/docs/protocols#diskurs.protocols.CallTool"><code>CallTool</code></a>]) – An optional callable tool that can be used during the heuristic sequence.</li>
</ul>
</li>
<li><strong>Return type:</strong>
<a href="/diskurs/docs/protocols#diskurs.protocols.Conversation"><code>Conversation</code></a></li>
<li><strong>Returns:</strong>
The updated conversation object after processing the heuristic sequence.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create_user_prompt_argumentprompt_args-3">create_user_prompt_argument(**prompt_args)<a href="#create_user_prompt_argumentprompt_args-3" class="hash-link" aria-label="Direct link to create_user_prompt_argument(**prompt_args)" title="Direct link to create_user_prompt_argument(**prompt_args)">​</a></h4>
<p>Creates an instance of the user prompt argument dataclass.</p>
<p>This method is responsible for generating the user prompt argument
based on the provided keyword arguments. The user prompt argument
is used to configure the user’s input and context for the conversation.</p>
<ul>
<li><strong>Parameters:</strong>
<strong>prompt_args</strong> – Keyword arguments used to initialize the user prompt argument.</li>
<li><strong>Return type:</strong>
<code>PromptArgument</code></li>
<li><strong>Returns:</strong>
An instance of the user prompt argument dataclass.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="render_user_templatename-prompt_args-message_typemessagetypeconversation-3">render_user_template(name, prompt_args, message_type=MessageType.CONVERSATION)<a href="#render_user_templatename-prompt_args-message_typemessagetypeconversation-3" class="hash-link" aria-label="Direct link to render_user_template(name, prompt_args, message_type=MessageType.CONVERSATION)" title="Direct link to render_user_template(name, prompt_args, message_type=MessageType.CONVERSATION)">​</a></h4>
<p>Renders the user template with the provided prompt arguments.</p>
<p>This method is responsible for rendering the user template using the given prompt arguments.
It generates a ChatMessage object that represents the rendered template.</p>
<ul>
<li><strong>Parameters:</strong>
<ul>
<li><strong>name</strong> (<code>str</code>) – The name of the template to be rendered.</li>
<li><strong>prompt_args</strong> (<code>PromptArgument</code>) – The prompt arguments to be used for rendering the template.</li>
<li><strong>message_type</strong> (<code>MessageType</code>) – The type of the message to be rendered. Defaults to MessageType.CONVERSATION.</li>
</ul>
</li>
<li><strong>Return type:</strong>
<code>ChatMessage</code></li>
<li><strong>Returns:</strong>
A ChatMessage object containing the rendered template.</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/agentic-diskurs/diskurs/edit/main/docs-site/docs/prompt.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/diskurs/docs/multistep_agent"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Module: Multistep Agent</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/diskurs/docs/protocols"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Protocols</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#exception-diskurspromptpromptvalidationerrormessage" class="table-of-contents__link toc-highlight"><em>exception</em> diskurs.prompt.PromptValidationError(message)</a></li><li><a href="#class-diskurspromptdefaultconductorsystempromptargumentagent_descriptions" class="table-of-contents__link toc-highlight"><em>class</em> diskurs.prompt.DefaultConductorSystemPromptArgument(agent_descriptions)</a></li><li><a href="#class-diskurspromptdefaultconductoruserpromptargumentnext_agentnone" class="table-of-contents__link toc-highlight"><em>class</em> diskurs.prompt.DefaultConductorUserPromptArgument(next_agent=None)</a></li><li><a href="#diskurspromptload_symbolsymbol_name-loaded_module" class="table-of-contents__link toc-highlight">diskurs.prompt.load_symbol(symbol_name, loaded_module)</a></li><li><a href="#diskurspromptload_templatelocation" class="table-of-contents__link toc-highlight">diskurs.prompt.load_template(location)</a></li><li><a href="#class-diskurspromptpromptparsermixin" class="table-of-contents__link toc-highlight"><em>class</em> diskurs.prompt.PromptParserMixin</a></li><li><a href="#class-diskurspromptpromptrenderermixinsystem_prompt_argument_class-user_prompt_argument_class-system_template-user_template-json_formatting_templatenone-is_validnone-is_finalnone" class="table-of-contents__link toc-highlight"><em>class</em> diskurs.prompt.PromptRendererMixin(system_prompt_argument_class, user_prompt_argument_class, system_template, user_template, json_formatting_template=None, is_valid=None, is_final=None)</a></li><li><a href="#class-diskurspromptpromptloadermixin" class="table-of-contents__link toc-highlight"><em>class</em> diskurs.prompt.PromptLoaderMixin</a></li><li><a href="#class-diskurspromptmultisteppromptagent_description-system_template-user_template-system_prompt_argument_class-user_prompt_argument_class-json_formatting_templatenone-is_validnone-is_finalnone" class="table-of-contents__link toc-highlight"><em>class</em> diskurs.prompt.MultistepPrompt(agent_description, system_template, user_template, system_prompt_argument_class, user_prompt_argument_class, json_formatting_template=None, is_valid=None, is_final=None)</a></li><li><a href="#class-diskurspromptconductorpromptagent_description-system_template-user_template-system_prompt_argument_class-user_prompt_argument_class-json_formatting_templatenone-longterm_memory_classnone-can_finalizenone-finalizenone-failnone-topicsnone" class="table-of-contents__link toc-highlight"><em>class</em> diskurs.prompt.ConductorPrompt(agent_description, system_template, user_template, system_prompt_argument_class, user_prompt_argument_class, json_formatting_template=None, longterm_memory_class=None, can_finalize=None, finalize=None, fail=None, topics=None)</a></li><li><a href="#class-diskurspromptheuristicpromptuser_prompt_argument_class-heuristic_sequence-user_templatenone-agent_description" class="table-of-contents__link toc-highlight"><em>class</em> diskurs.prompt.HeuristicPrompt(user_prompt_argument_class, heuristic_sequence, user_template=None, agent_description=&#39;&#39;)</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/diskurs/docs">Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/agentic-diskurs/diskurs/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Issues<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/diskurs/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/agentic-diskurs/diskurs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Agentic Diskurs.</div></div></div></footer></div>
</body>
</html>