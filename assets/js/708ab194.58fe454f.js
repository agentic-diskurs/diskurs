"use strict";(self.webpackChunkdocs_site=self.webpackChunkdocs_site||[]).push([[5115],{6674:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"multistep_agent","title":"Module: Multistep Agent","description":"class diskurs.multistepagent.MultiStepAgent(name, prompt, llmclient, topics=None, dispatcher=None, toolexecutor=None, tools=None, maxreasoningsteps=5, maxtrials=5, initpromptargumentswithlongterm_memory=True)","source":"@site/docs/multistep_agent.md","sourceDirName":".","slug":"/multistep_agent","permalink":"/diskurs/docs/multistep_agent","draft":false,"unlisted":false,"editUrl":"https://github.com/agentic-diskurs/diskurs/edit/main/docs-site/docs/multistep_agent.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Module: LLM Client","permalink":"/diskurs/docs/llm_client"},"next":{"title":"Module: Prompt","permalink":"/diskurs/docs/prompt"}}');var t=n(4848),o=n(8453);const i={},l="Module: Multistep Agent",c={},a=[{value:"<em>class</em> diskurs.multistep_agent.MultiStepAgent(name, prompt, llm_client, topics=None, dispatcher=None, tool_executor=None, tools=None, max_reasoning_steps=5, max_trials=5, init_prompt_arguments_with_longterm_memory=True)",id:"class-diskursmultistep_agentmultistepagentname-prompt-llm_client-topicsnone-dispatchernone-tool_executornone-toolsnone-max_reasoning_steps5-max_trials5-init_prompt_arguments_with_longterm_memorytrue",level:3},{value:"<em>classmethod</em> create(name, prompt, llm_client, **kwargs)",id:"classmethod-createname-prompt-llm_client-kwargs",level:4},{value:"get_conductor_name()",id:"get_conductor_name",level:4},{value:"register_tools(tools)",id:"register_toolstools",level:4},{value:"compute_tool_response(response)",id:"compute_tool_responseresponse",level:4},{value:"generate_validated_response(conversation, message_type=MessageType.CONVERSATION)",id:"generate_validated_responseconversation-message_typemessagetypeconversation",level:4},{value:"invoke(conversation)",id:"invokeconversation",level:4},{value:"process_conversation(conversation)",id:"process_conversationconversation",level:4},{value:"prepare_conversation(conversation, system_prompt_argument, user_prompt_argument, message_type=MessageType.CONVERSATION)",id:"prepare_conversationconversation-system_prompt_argument-user_prompt_argument-message_typemessagetypeconversation",level:4},{value:"register_dispatcher(dispatcher)",id:"register_dispatcherdispatcher",level:4},{value:"return_fail_validation_message(response)",id:"return_fail_validation_messageresponse",level:4},{value:"<em>property</em> topics <em>: list[str]</em>",id:"property-topics--liststr",level:4},{value:"name <em>: <code>str</code></em>",id:"name--str",level:4}];function d(e){const s={a:"a",code:"code",em:"em",h1:"h1",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"module-multistep-agent",children:"Module: Multistep Agent"})}),"\n",(0,t.jsxs)(s.h3,{id:"class-diskursmultistep_agentmultistepagentname-prompt-llm_client-topicsnone-dispatchernone-tool_executornone-toolsnone-max_reasoning_steps5-max_trials5-init_prompt_arguments_with_longterm_memorytrue",children:[(0,t.jsx)(s.em,{children:"class"})," diskurs.multistep_agent.MultiStepAgent(name, prompt, llm_client, topics=None, dispatcher=None, tool_executor=None, tools=None, max_reasoning_steps=5, max_trials=5, init_prompt_arguments_with_longterm_memory=True)"]}),"\n",(0,t.jsxs)(s.p,{children:["Bases: ",(0,t.jsx)(s.code,{children:"BaseAgent"}),"[",(0,t.jsx)(s.a,{href:"/diskurs/docs/protocols#diskurs.protocols.MultistepPrompt",children:(0,t.jsx)(s.code,{children:"MultistepPrompt"})}),"]"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Parameters:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"name"})," (",(0,t.jsx)(s.em,{children:"str"}),")"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"prompt"})," (",(0,t.jsx)(s.a,{href:"/diskurs/docs/protocols#diskurs.protocols.MultistepPrompt",children:(0,t.jsx)(s.em,{children:"MultistepPrompt"})}),")"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"llm_client"})," (",(0,t.jsx)(s.a,{href:"/diskurs/docs/protocols#diskurs.protocols.LLMClient",children:(0,t.jsx)(s.em,{children:"LLMClient"})}),")"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"topics"})," (",(0,t.jsx)(s.em,{children:"list"})," *[*",(0,t.jsx)(s.em,{children:"str"})," ",(0,t.jsx)(s.em,{children:"]"}),")"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"dispatcher"})," (",(0,t.jsx)(s.a,{href:"/diskurs/docs/protocols#diskurs.protocols.ConversationDispatcher",children:(0,t.jsx)(s.em,{children:"ConversationDispatcher"})})," ",(0,t.jsx)(s.em,{children:"|"})," ",(0,t.jsx)(s.em,{children:"None"}),")"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"tool_executor"})," (",(0,t.jsx)(s.a,{href:"/diskurs/docs/protocols#diskurs.protocols.ToolExecutor",children:(0,t.jsx)(s.em,{children:"ToolExecutor"})})," ",(0,t.jsx)(s.em,{children:"|"})," ",(0,t.jsx)(s.em,{children:"None"}),")"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"tools"})," (",(0,t.jsx)(s.em,{children:"list"})," *[*",(0,t.jsx)(s.em,{children:"ToolDescription"})," ",(0,t.jsx)(s.em,{children:"]"}),"  ",(0,t.jsx)(s.em,{children:"|"})," ",(0,t.jsx)(s.em,{children:"None"}),")"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"max_reasoning_steps"})," (",(0,t.jsx)(s.em,{children:"int"}),")"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"max_trials"})," (",(0,t.jsx)(s.em,{children:"int"}),")"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"init_prompt_arguments_with_longterm_memory"})," (",(0,t.jsx)(s.em,{children:"bool"}),")"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.h4,{id:"classmethod-createname-prompt-llm_client-kwargs",children:[(0,t.jsx)(s.em,{children:"classmethod"})," create(name, prompt, llm_client, **kwargs)"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Return type:"}),"\n",(0,t.jsx)(s.code,{children:"Self"})]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Parameters:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"name"})," (",(0,t.jsx)(s.em,{children:"str"}),")"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"prompt"})," (",(0,t.jsx)(s.a,{href:"/diskurs/docs/protocols#diskurs.protocols.MultistepPrompt",children:(0,t.jsx)(s.em,{children:"MultistepPrompt"})}),")"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"llm_client"})," (",(0,t.jsx)(s.a,{href:"/diskurs/docs/protocols#diskurs.protocols.LLMClient",children:(0,t.jsx)(s.em,{children:"LLMClient"})}),")"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"get_conductor_name",children:"get_conductor_name()"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Return type:"}),"\n",(0,t.jsx)(s.code,{children:"str"})]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"register_toolstools",children:"register_tools(tools)"}),"\n",(0,t.jsx)(s.p,{children:"Registers one or more tools with the executor."}),"\n",(0,t.jsx)(s.p,{children:"This method allows the registration of a single tool or a list of tools\nthat can be executed by the executor. Each tool is a callable that can\nbe invoked with specific arguments."}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Parameters:"}),"\n",(0,t.jsx)(s.strong,{children:"tools"})," (",(0,t.jsx)(s.code,{children:"Union"}),"[",(0,t.jsx)(s.code,{children:"list"}),"[",(0,t.jsx)(s.code,{children:"Callable"}),"], ",(0,t.jsx)(s.code,{children:"Callable"}),"]) \u2013 A single callable or a list of callables representing the tools to be registered."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Return type:"}),"\n",(0,t.jsx)(s.code,{children:"None"})]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"compute_tool_responseresponse",children:"compute_tool_response(response)"}),"\n",(0,t.jsx)(s.p,{children:"Executes the tool calls in the response and returns the tool responses."}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Parameters:"}),"\n",(0,t.jsx)(s.strong,{children:"response"})," (",(0,t.jsx)(s.a,{href:"/diskurs/docs/protocols#diskurs.protocols.Conversation",children:(0,t.jsx)(s.code,{children:"Conversation"})}),") \u2013 The conversation object containing the tool calls to execute."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Return type:"}),"\n",(0,t.jsx)(s.code,{children:"list"}),"[",(0,t.jsx)(s.code,{children:"ChatMessage"}),"]"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Returns:"}),"\nOne or more ChatMessage objects containing the tool responses."]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"generate_validated_responseconversation-message_typemessagetypeconversation",children:"generate_validated_response(conversation, message_type=MessageType.CONVERSATION)"}),"\n",(0,t.jsx)(s.p,{children:"Generates a validated response for the given conversation."}),"\n",(0,t.jsx)(s.p,{children:"This method attempts to generate a valid response for the conversation by\ninteracting with the LLM client and validating the response. It performs\nmultiple trials if necessary, and handles tool calls and corrective messages."}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Parameters:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"conversation"})," (",(0,t.jsx)(s.a,{href:"/diskurs/docs/protocols#diskurs.protocols.Conversation",children:(0,t.jsx)(s.code,{children:"Conversation"})}),") \u2013 The conversation object to generate a response for."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"message_type"})," (",(0,t.jsx)(s.code,{children:"MessageType"}),") \u2013 The type of message to render the user prompt as, defaults to MessageType.CONVERSATION."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Return type:"}),"\n",(0,t.jsx)(s.a,{href:"/diskurs/docs/protocols#diskurs.protocols.Conversation",children:(0,t.jsx)(s.code,{children:"Conversation"})})]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Returns:"}),"\nThe updated conversation object with the validated response."]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"invokeconversation",children:"invoke(conversation)"}),"\n",(0,t.jsx)(s.p,{children:"Run the agent on a conversation."}),"\n",(0,t.jsx)(s.p,{children:"This method processes the given conversation by invoking the agent\u2019s logic.\nIt takes a Conversation object representing the conversation\nand returns an updated Conversation object after processing."}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Parameters:"}),"\n",(0,t.jsx)(s.strong,{children:"conversation"})," (",(0,t.jsx)(s.a,{href:"/diskurs/docs/protocols#diskurs.protocols.Conversation",children:(0,t.jsx)(s.code,{children:"Conversation"})}),") \u2013 The current state of the conversation, represented as a Conversation object"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Return type:"}),"\n",(0,t.jsx)(s.a,{href:"/diskurs/docs/protocols#diskurs.protocols.Conversation",children:(0,t.jsx)(s.code,{children:"Conversation"})})]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Returns:"}),"\nAn updated Conversation object with the processed state."]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"process_conversationconversation",children:"process_conversation(conversation)"}),"\n",(0,t.jsx)(s.p,{children:"Receives a conversation from the dispatcher, i.e. message bus, processes it and finally publishes\na deep copy of the resulting conversation back to the dispatcher."}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Parameters:"}),"\n",(0,t.jsx)(s.strong,{children:"conversation"})," (",(0,t.jsx)(s.a,{href:"/diskurs/docs/protocols#diskurs.protocols.Conversation",children:(0,t.jsx)(s.code,{children:"Conversation"})}),") \u2013 The conversation object to process."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Return type:"}),"\n",(0,t.jsx)(s.code,{children:"None"})]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"prepare_conversationconversation-system_prompt_argument-user_prompt_argument-message_typemessagetypeconversation",children:"prepare_conversation(conversation, system_prompt_argument, user_prompt_argument, message_type=MessageType.CONVERSATION)"}),"\n",(0,t.jsx)(s.p,{children:"Ensures the conversation is in a valid state by creating a new set of prompts\nand prompt_variables for system and user, as well creating a fresh copy of the conversation."}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Parameters:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"conversation"})," (",(0,t.jsx)(s.a,{href:"/diskurs/docs/protocols#diskurs.protocols.Conversation",children:(0,t.jsx)(s.code,{children:"Conversation"})}),") \u2013 A conversation object, possible passed from another agent\nor a string to start a new conversation."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"system_prompt_argument"})," (",(0,t.jsx)(s.code,{children:"PromptArgument"}),") \u2013 The system prompt argument to use for the system prompt."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"user_prompt_argument"})," (",(0,t.jsx)(s.code,{children:"PromptArgument"}),") \u2013 The user prompt argument to use for the user prompt."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"message_type"})," (",(0,t.jsx)(s.code,{children:"MessageType"}),") \u2013 The type of message to render the user prompt as."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Return type:"}),"\n",(0,t.jsx)(s.a,{href:"/diskurs/docs/protocols#diskurs.protocols.Conversation",children:(0,t.jsx)(s.code,{children:"Conversation"})})]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Returns:"}),"\nA deep copy of the conversation, in a valid state for this agent"]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"register_dispatcherdispatcher",children:"register_dispatcher(dispatcher)"}),"\n",(0,t.jsx)(s.p,{children:"Registers a dispatcher with the conversation participant."}),"\n",(0,t.jsx)(s.p,{children:"This method is responsible for associating a ConversationDispatcher with the\nconversation participant. The dispatcher will handle the distribution and management\nof conversations involving this participant."}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Parameters:"}),"\n",(0,t.jsx)(s.strong,{children:"dispatcher"})," (",(0,t.jsx)(s.a,{href:"/diskurs/docs/protocols#diskurs.protocols.ConversationDispatcher",children:(0,t.jsx)(s.code,{children:"ConversationDispatcher"})}),") \u2013 The ConversationDispatcher instance to be registered."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Return type:"}),"\n",(0,t.jsx)(s.code,{children:"None"})]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"return_fail_validation_messageresponse",children:"return_fail_validation_message(response)"}),"\n",(0,t.jsxs)(s.h4,{id:"property-topics--liststr",children:[(0,t.jsx)(s.em,{children:"property"})," topics ",(0,t.jsx)(s.em,{children:": list[str]"})]}),"\n",(0,t.jsxs)(s.h4,{id:"name--str",children:["name ",(0,t.jsxs)(s.em,{children:[": ",(0,t.jsx)(s.code,{children:"str"})]})]})]})}function h(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>i,x:()=>l});var r=n(6540);const t={},o=r.createContext(t);function i(e){const s=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),r.createElement(o.Provider,{value:s},e.children)}}}]);